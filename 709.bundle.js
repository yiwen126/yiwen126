(self.webpackChunkcanvas_blog=self.webpackChunkcanvas_blog||[]).push([[709],{709:(t,e,i)=>{"use strict";function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function h(){var t=300,e=.98,i=1,o=3,r=3,h=80,l=2,c=document.querySelector("#firework");c.style.background="black";var u,d,f=c.getContext("2d");function w(){d=c.height=window.innerHeight;var t=c.closest("section");u=c.width=t.clientWidth}function v(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}w(),window.addEventListener("resize",w);var m=function(){function e(t,i,n,o){s(this,e),this.nowX=this.startX=t,this.nowY=this.startY=i,this.targetX=n,this.targetY=o,this.collection=Array(10),this.angle=Math.atan2(o-i,n-t),this.lastUpdateTime=Date.now()}return a(e,[{key:"draw",value:function(){var t;f.beginPath();try{f.moveTo.apply(f,n(this.collection[0])),t=f.createLinearGradient.apply(f,n(this.collection[0]).concat([this.nowX,this.nowY]))}catch(e){f.moveTo(this.startX,this.startY),t=f.createLinearGradient(this.startX,this.startY,this.nowX,this.nowY)}t.addColorStop(0,"rgba(255, 255, 255, 0)"),t.addColorStop(1,"rgba(255, 255, 255, 1)"),f.strokeStyle=t,f.lineWidth=1,f.lineTo(this.nowX,this.nowY),f.stroke()}},{key:"update",value:function(){if(this.collection.push([this.nowX,this.nowY]),this.collection.shift(),this.collection[0]&&this.collection[0][1]<=this.targetY)this.over=!0;else if(!(this.nowY<=this.targetY)){var e=Date.now();this.nowX+=Math.cos(this.angle)*t*(e-this.lastUpdateTime)/1e3,this.nowY+=Math.sin(this.angle)*t*(e-this.lastUpdateTime)/1e3,this.lastUpdateTime=e}}},{key:"init",value:function(){this.update(),this.draw()}}]),e}(),y=function(){function n(i,a,h){s(this,n),this.nowX=i,this.nowY=a,this.angle=h,this.acceleration=e,this.startTime=this.lastUpdateTime=Date.now(),this.speed=t*Math.random(),this.width=o,this.height=r,this.fillStyle="rgb(".concat(v(0,255),",").concat(v(0,255),",").concat(v(0,255),")"),this.overTime=l*Math.random()}return a(n,[{key:"init",value:function(){this.update(),this.draw()}},{key:"update",value:function(){var t=Date.now();(t-this.startTime)/1e3>this.overTime?this.over=!0:(this.speed*=this.acceleration,this.nowX+=Math.cos(this.angle)*this.speed*(t-this.lastUpdateTime)/1e3,this.nowY+=Math.sin(this.angle)*this.speed*(t-this.lastUpdateTime)/1e3+i,this.lastUpdateTime=t)}},{key:"draw",value:function(){f.save(),f.translate(-this.width,-this.height),f.fillStyle=this.fillStyle,f.fillRect(this.nowX,this.nowY,this.width,this.height),f.restore()}}]),n}(),p=new(function(){function t(){s(this,t),this.biu=[],this.booms=[],this.sigleFire=!0,this.shoot=this.shoot.bind(this),this.render=this.render.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}return a(t,[{key:"pushBooms",value:function(t,e){for(var i=0;i<h;i++)this.booms.push(new y(t,e,Math.random()*Math.PI*2))}},{key:"init",value:function(){this.listenInput(),this.render()}},{key:"listenInput",value:function(){window.addEventListener("keydown",this.handleKeyDown,!1),c.addEventListener("click",this.shoot,!1)}},{key:"handleKeyDown",value:function(){this.sigleFire?(c.removeEventListener("click",this.shoot,!1),c.addEventListener("mousemove",this.shoot,!1),this.sigleFire=!1):(c.removeEventListener("mousemove",this.shoot,!1),c.addEventListener("click",this.shoot,!1),this.sigleFire=!0)}},{key:"shoot",value:function(t){var e,i,n,o,s,r=(e=t,i=c.getBoundingClientRect(),{x:e.clientX-i.left,y:e.clientY-i.top});o=(n=r).x,s=n.y,o>=0&&o<=c.width&&s>=0&&s<=c.height&&this.biu.push(new m(0,d,r.x,r.y))}},{key:"render",value:function(){var t=this;f.save(),f.fillStyle="rgba(0,0,0,0.1)",f.fillRect(0,0,u,d),f.restore(),this.biu.forEach((function(e,i){e.init(),e.over&&(t.pushBooms(e.targetX,e.targetY),t.biu.splice(i,1))})),this.booms.forEach((function(e,i){e.init(),e.over&&t.booms.splice(i,1)})),this.renderID=requestAnimationFrame(this.render)}},{key:"exit",value:function(){this.renderID&&window.cancelAnimationFrame(this.renderID),window.removeEventListener("keydown",this.handleKeyDown,!1),c.removeEventListener("mousemove",this.shoot,!1),c.removeEventListener("click",this.shoot,!1)}}]),t}());return p.init(),function(){p.exit(),p=null,window.removeEventListener("resize",w)}}i.r(e),i.d(e,{init:()=>h})}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYW52YXMtYmxvZy8uL3NyYy9jbGllbnQvanMvZmlyZXdvcmsuanMiXSwibmFtZXMiOlsiaW5pdCIsImNvbmZpZyIsImNhbnZhcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInN0eWxlIiwiYmFja2dyb3VuZCIsImN3IiwiY2giLCJjdHgiLCJnZXRDb250ZXh0Iiwic2V0Q2FudmFzU2l6ZSIsImhlaWdodCIsIndpbmRvdyIsImlubmVySGVpZ2h0Iiwic2VjdGlvbiIsImNsb3Nlc3QiLCJ3aWR0aCIsImNsaWVudFdpZHRoIiwiZ2V0UmFuZG9tSW50SW5jbHVzaXZlIiwibWluIiwibWF4IiwiTWF0aCIsImNlaWwiLCJmbG9vciIsInJhbmRvbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJCaXUiLCJzdGFydFgiLCJzdGFydFkiLCJ0YXJnZXRYIiwidGFyZ2V0WSIsInRoaXMiLCJub3dYIiwibm93WSIsImNvbGxlY3Rpb24iLCJBcnJheSIsImFuZ2xlIiwiYXRhbjIiLCJsYXN0VXBkYXRlVGltZSIsIkRhdGUiLCJub3ciLCJncmQiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJjcmVhdGVMaW5lYXJHcmFkaWVudCIsImUiLCJhZGRDb2xvclN0b3AiLCJzdHJva2VTdHlsZSIsImxpbmVXaWR0aCIsImxpbmVUbyIsInN0cm9rZSIsInB1c2giLCJzaGlmdCIsIm92ZXIiLCJub3dUaW1lIiwiY29zIiwic2luIiwidXBkYXRlIiwiZHJhdyIsIkJvb20iLCJ4IiwieSIsImFjY2VsZXJhdGlvbiIsInN0YXJ0VGltZSIsInNwZWVkIiwiZmlsbFN0eWxlIiwib3ZlclRpbWUiLCJzYXZlIiwidHJhbnNsYXRlIiwiZmlsbFJlY3QiLCJyZXN0b3JlIiwiZ2FtZSIsImJpdSIsImJvb21zIiwic2lnbGVGaXJlIiwic2hvb3QiLCJiaW5kIiwicmVuZGVyIiwiaGFuZGxlS2V5RG93biIsImkiLCJQSSIsImxpc3RlbklucHV0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicmVjdCIsInBvcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImNsaWVudFgiLCJsZWZ0IiwiY2xpZW50WSIsInRvcCIsImZvckVhY2giLCJ2IiwicHVzaEJvb21zIiwic3BsaWNlIiwicmVuZGVySUQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsImV4aXQiXSwibWFwcGluZ3MiOiJrcUNBQU8sU0FBU0EsSUFDZCxJQUFNQyxFQUNNLElBRE5BLEVBRWEsSUFGYkEsRUFHVyxFQUhYQSxFQUlPLEVBSlBBLEVBS1EsRUFMUkEsRUFNSyxHQU5MQSxFQU9VLEVBRVZDLEVBQVNDLFNBQVNDLGNBQWMsYUFDdENGLEVBQU9HLE1BQU1DLFdBQWEsUUFDMUIsSUFFSUMsRUFBSUMsRUFGRkMsRUFBTVAsRUFBT1EsV0FBVyxNQUc5QixTQUFTQyxJQUVQSCxFQUFLTixFQUFPVSxPQUFTQyxPQUFPQyxZQUM1QixJQUFJQyxFQUFVYixFQUFPYyxRQUFRLFdBQzdCVCxFQUFLTCxFQUFPZSxNQUFRRixFQUFRRyxZQUs5QixTQUFTQyxFQUFzQkMsRUFBS0MsR0FHbEMsT0FGQUQsRUFBTUUsS0FBS0MsS0FBS0gsR0FDaEJDLEVBQU1DLEtBQUtFLE1BQU1ILEdBQ1ZDLEtBQUtFLE1BQU1GLEtBQUtHLFVBQVlKLEVBQU1ELEVBQU0sSUFBTUEsRUFOdkRULElBQ0FFLE9BQU9hLGlCQUFpQixTQUFVZixHQXRCYixJQTBDZmdCLEVBMUNlLFdBMkNuQixXQUFZQyxFQUFRQyxFQUFRQyxFQUFTQyxHQUFTLFVBQzVDQyxLQUFLQyxLQUFPRCxLQUFLSixPQUFTQSxFQUMxQkksS0FBS0UsS0FBT0YsS0FBS0gsT0FBU0EsRUFDMUJHLEtBQUtGLFFBQVVBLEVBQ2ZFLEtBQUtELFFBQVVBLEVBRWZDLEtBQUtHLFdBQWFDLE1BQU0sSUFFeEJKLEtBQUtLLE1BQVFmLEtBQUtnQixNQUFNUCxFQUFVRixFQUFRQyxFQUFVRixHQUNwREksS0FBS08sZUFBaUJDLEtBQUtDLE1BcERWLDhCQXNE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R0FySUd6QixFQUFHQyxFQUFLLEVBQUxBLEVBQ2hCRCxHQUFLLEdBQUtBLEdBQUszRCxFQUFPZSxPQUFTNkMsR0FBSyxHQUFLQSxHQUFLNUQsRUFBT1UsUUFxSXhEb0IsS0FBS3lDLElBQUlyQixLQUFLLElBQUl6QixFQUFJLEVBQUduQixFQUFJOEUsRUFBSXpCLEVBQUd5QixFQUFJeEIsTUExS3pCLG9CQTZLbkIsV0FBUyxXQUNQckQsRUFBSTJELE9BQ0ozRCxFQUFJeUQsVUFBWSxrQkFDaEJ6RCxFQUFJNkQsU0FBUyxFQUFHLEVBQUcvRCxFQUFJQyxHQUN2QkMsRUFBSThELFVBQ0p2QyxLQUFLeUMsSUFBSW1CLFNBQVEsU0FBQ0MsRUFBR2IsR0FDbkJhLEVBQUU3RixPQUNFNkYsRUFBRXZDLE9BQ0osRUFBS3dDLFVBQVVELEVBQUUvRCxRQUFTK0QsRUFBRTlELFNBQzVCLEVBQUswQyxJQUFJc0IsT0FBT2YsRUFBRyxPQUd2QmhELEtBQUswQyxNQUFNa0IsU0FBUSxTQUFDQyxFQUFHYixHQUNyQmEsRUFBRTdGLE9BQ0U2RixFQUFFdkMsTUFDSixFQUFLb0IsTUFBTXFCLE9BQU9mLEVBQUcsTUFHekJoRCxLQUFLZ0UsU0FBV0Msc0JBQXNCakUsS0FBSzhDLFVBL0wxQixrQkFpTW5CLFdBQ005QyxLQUFLZ0UsVUFDUG5GLE9BQU9xRixxQkFBcUJsRSxLQUFLZ0UsVUFFbkNuRixPQUFPc0Usb0JBQW9CLFVBQVduRCxLQUFLK0MsZUFBZSxHQUMxRDdFLEVBQU9pRixvQkFBb0IsWUFBYW5ELEtBQUs0QyxPQUFPLEdBQ3BEMUUsRUFBT2lGLG9CQUFvQixRQUFTbkQsS0FBSzRDLE9BQU8sT0F2TS9CLE1BNk1yQixPQUZBSixFQUFLeEUsT0FFRSxXQUNMd0UsRUFBSzJCLE9BQ0wzQixFQUFPLEtBQ1AzRCxPQUFPc0Usb0JBQW9CLFNBQVV4RSxJIiwiZmlsZSI6IjcwOS5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gaW5pdCgpIHtcclxuICBjb25zdCBjb25maWcgPSB7XHJcbiAgICBCSVVTUEVFRDogMzAwLCAvL+WDj+e0oC9zXHJcbiAgICBCT09NQUNDRUxFUlJBVEU6IDAuOTgsXHJcbiAgICBCT09NRE9XTlNQRUVEOiAxLFxyXG4gICAgQk9PTVdJRFRIOiAzLFxyXG4gICAgQk9PTUhFSUdIVDogMyxcclxuICAgIEJPT01OVU06IDgwLFxyXG4gICAgQk9PTU9WRVJUSU1FOiAyLCAvL+WkmuWwkeenkuWQjua2iOWksVxyXG4gIH07XHJcbiAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2ZpcmV3b3JrJyk7XHJcbiAgY2FudmFzLnN0eWxlLmJhY2tncm91bmQgPSAnYmxhY2snO1xyXG4gIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gIC8vIGNsaWVudFdpZHRoLGNsaWVudEhlaWdodFxyXG4gIGxldCBjdywgY2g7XHJcbiAgZnVuY3Rpb24gc2V0Q2FudmFzU2l6ZSgpIHtcclxuICAgIC8vIOazqOaEj+i/memHjOeahOmhuuW6j+imgeWFiOmrmOW6pu+8iOWHuua7muWKqOadoe+8ieWQjuWuveW6plxyXG4gICAgY2ggPSBjYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG4gICAgbGV0IHNlY3Rpb24gPSBjYW52YXMuY2xvc2VzdCgnc2VjdGlvbicpO1xyXG4gICAgY3cgPSBjYW52YXMud2lkdGggPSBzZWN0aW9uLmNsaWVudFdpZHRoO1xyXG4gIH1cclxuICBzZXRDYW52YXNTaXplKCk7XHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHNldENhbnZhc1NpemUpO1xyXG5cclxuICBmdW5jdGlvbiBnZXRSYW5kb21JbnRJbmNsdXNpdmUobWluLCBtYXgpIHtcclxuICAgIG1pbiA9IE1hdGguY2VpbChtaW4pO1xyXG4gICAgbWF4ID0gTWF0aC5mbG9vcihtYXgpO1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47IC8v5ZCr5pyA5aSn5YC877yM5ZCr5pyA5bCP5YC8XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIGdldFBvc0luQ2FudmFzKGUpIHtcclxuICAgIGxldCByZWN0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogZS5jbGllbnRYIC0gcmVjdC5sZWZ0LFxyXG4gICAgICB5OiBlLmNsaWVudFkgLSByZWN0LnRvcCxcclxuICAgIH07XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIGlzSW5DYW52YXMoeyB4LCB5IH0pIHtcclxuICAgIHJldHVybiB4ID49IDAgJiYgeCA8PSBjYW52YXMud2lkdGggJiYgeSA+PSAwICYmIHkgPD0gY2FudmFzLmhlaWdodDtcclxuICB9XHJcbiAgZnVuY3Rpb24gcmFuZG9tQ29sb3IoKSB7XHJcbiAgICByZXR1cm4gYHJnYigke2dldFJhbmRvbUludEluY2x1c2l2ZSgwLCAyNTUpfSwke2dldFJhbmRvbUludEluY2x1c2l2ZSgwLCAyNTUpfSwke2dldFJhbmRvbUludEluY2x1c2l2ZSgwLCAyNTUpfSlgO1xyXG4gIH1cclxuICBjbGFzcyBCaXUge1xyXG4gICAgY29uc3RydWN0b3Ioc3RhcnRYLCBzdGFydFksIHRhcmdldFgsIHRhcmdldFkpIHtcclxuICAgICAgdGhpcy5ub3dYID0gdGhpcy5zdGFydFggPSBzdGFydFg7XHJcbiAgICAgIHRoaXMubm93WSA9IHRoaXMuc3RhcnRZID0gc3RhcnRZO1xyXG4gICAgICB0aGlzLnRhcmdldFggPSB0YXJnZXRYO1xyXG4gICAgICB0aGlzLnRhcmdldFkgPSB0YXJnZXRZO1xyXG4gICAgICAvLyDlrZjmlL7kuYvliY3nmoTlnZDmoIdcclxuICAgICAgdGhpcy5jb2xsZWN0aW9uID0gQXJyYXkoMTApO1xyXG4gICAgICAvLyDlgL7op5JcclxuICAgICAgdGhpcy5hbmdsZSA9IE1hdGguYXRhbjIodGFyZ2V0WSAtIHN0YXJ0WSwgdGFyZ2V0WCAtIHN0YXJ0WCk7XHJcbiAgICAgIHRoaXMubGFzdFVwZGF0ZVRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgfVxyXG4gICAgZHJhdygpIHtcclxuICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICBsZXQgZ3JkO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGN0eC5tb3ZlVG8oLi4udGhpcy5jb2xsZWN0aW9uWzBdKTtcclxuICAgICAgICBncmQgPSBjdHguY3JlYXRlTGluZWFyR3JhZGllbnQoLi4udGhpcy5jb2xsZWN0aW9uWzBdLCB0aGlzLm5vd1gsIHRoaXMubm93WSk7XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjdHgubW92ZVRvKHRoaXMuc3RhcnRYLCB0aGlzLnN0YXJ0WSk7XHJcbiAgICAgICAgZ3JkID0gY3R4LmNyZWF0ZUxpbmVhckdyYWRpZW50KHRoaXMuc3RhcnRYLCB0aGlzLnN0YXJ0WSwgdGhpcy5ub3dYLCB0aGlzLm5vd1kpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBncmQuYWRkQ29sb3JTdG9wKDAsICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDApJyk7XHJcbiAgICAgIGdyZC5hZGRDb2xvclN0b3AoMSwgJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMSknKTtcclxuXHJcbiAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGdyZDtcclxuICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7XHJcbiAgICAgIGN0eC5saW5lVG8odGhpcy5ub3dYLCB0aGlzLm5vd1kpO1xyXG4gICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICB9XHJcbiAgICB1cGRhdGUoKSB7XHJcbiAgICAgIHRoaXMuY29sbGVjdGlvbi5wdXNoKFt0aGlzLm5vd1gsIHRoaXMubm93WV0pO1xyXG4gICAgICB0aGlzLmNvbGxlY3Rpb24uc2hpZnQoKTtcclxuICAgICAgaWYgKHRoaXMuY29sbGVjdGlvblswXSAmJiB0aGlzLmNvbGxlY3Rpb25bMF1bMV0gPD0gdGhpcy50YXJnZXRZKSB7XHJcbiAgICAgICAgdGhpcy5vdmVyID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubm93WSA8PSB0aGlzLnRhcmdldFkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgbGV0IG5vd1RpbWUgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgICAgdGhpcy5ub3dYICs9IChNYXRoLmNvcyh0aGlzLmFuZ2xlKSAqIGNvbmZpZy5CSVVTUEVFRCAqIChub3dUaW1lIC0gdGhpcy5sYXN0VXBkYXRlVGltZSkpIC8gMTAwMDtcclxuICAgICAgdGhpcy5ub3dZICs9IChNYXRoLnNpbih0aGlzLmFuZ2xlKSAqIGNvbmZpZy5CSVVTUEVFRCAqIChub3dUaW1lIC0gdGhpcy5sYXN0VXBkYXRlVGltZSkpIC8gMTAwMDtcclxuXHJcbiAgICAgIHRoaXMubGFzdFVwZGF0ZVRpbWUgPSBub3dUaW1lO1xyXG4gICAgfVxyXG4gICAgaW5pdCgpIHtcclxuICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgICAgdGhpcy5kcmF3KCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNsYXNzIEJvb20ge1xyXG4gICAgY29uc3RydWN0b3IoeCwgeSwgYW5nbGUpIHtcclxuICAgICAgdGhpcy5ub3dYID0geDtcclxuICAgICAgdGhpcy5ub3dZID0geTtcclxuICAgICAgdGhpcy5hbmdsZSA9IGFuZ2xlO1xyXG4gICAgICB0aGlzLmFjY2VsZXJhdGlvbiA9IGNvbmZpZy5CT09NQUNDRUxFUlJBVEU7XHJcbiAgICAgIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5sYXN0VXBkYXRlVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgIHRoaXMuc3BlZWQgPSBjb25maWcuQklVU1BFRUQgKiBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICB0aGlzLndpZHRoID0gY29uZmlnLkJPT01XSURUSDtcclxuICAgICAgdGhpcy5oZWlnaHQgPSBjb25maWcuQk9PTUhFSUdIVDtcclxuICAgICAgdGhpcy5maWxsU3R5bGUgPSByYW5kb21Db2xvcigpO1xyXG4gICAgICB0aGlzLm92ZXJUaW1lID0gY29uZmlnLkJPT01PVkVSVElNRSAqIE1hdGgucmFuZG9tKCk7XHJcbiAgICB9XHJcbiAgICBpbml0KCkge1xyXG4gICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgICB0aGlzLmRyYXcoKTtcclxuICAgIH1cclxuICAgIHVwZGF0ZSgpIHtcclxuICAgICAgbGV0IG5vd1RpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICBpZiAoKG5vd1RpbWUgLSB0aGlzLnN0YXJ0VGltZSkgLyAxMDAwID4gdGhpcy5vdmVyVGltZSkge1xyXG4gICAgICAgIHRoaXMub3ZlciA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc3BlZWQgKj0gdGhpcy5hY2NlbGVyYXRpb247XHJcbiAgICAgIHRoaXMubm93WCArPSAoTWF0aC5jb3ModGhpcy5hbmdsZSkgKiB0aGlzLnNwZWVkICogKG5vd1RpbWUgLSB0aGlzLmxhc3RVcGRhdGVUaW1lKSkgLyAxMDAwO1xyXG4gICAgICB0aGlzLm5vd1kgKz0gKE1hdGguc2luKHRoaXMuYW5nbGUpICogdGhpcy5zcGVlZCAqIChub3dUaW1lIC0gdGhpcy5sYXN0VXBkYXRlVGltZSkpIC8gMTAwMCArIGNvbmZpZy5CT09NRE9XTlNQRUVEO1xyXG4gICAgICB0aGlzLmxhc3RVcGRhdGVUaW1lID0gbm93VGltZTtcclxuICAgIH1cclxuICAgIGRyYXcoKSB7XHJcbiAgICAgIGN0eC5zYXZlKCk7XHJcbiAgICAgIC8vIOS4uuS6huiuqeWdkOagh+S9jeS6juefqeW9ouS4remXtFxyXG4gICAgICBjdHgudHJhbnNsYXRlKC10aGlzLndpZHRoLCAtdGhpcy5oZWlnaHQpO1xyXG5cclxuICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuZmlsbFN0eWxlO1xyXG4gICAgICBjdHguZmlsbFJlY3QodGhpcy5ub3dYLCB0aGlzLm5vd1ksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgY3R4LnJlc3RvcmUoKTtcclxuICAgIH1cclxuICB9XHJcbiAgY2xhc3MgR2FtZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgdGhpcy5iaXUgPSBbXTtcclxuICAgICAgdGhpcy5ib29tcyA9IFtdO1xyXG4gICAgICB0aGlzLnNpZ2xlRmlyZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuc2hvb3QgPSB0aGlzLnNob290LmJpbmQodGhpcyk7XHJcbiAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5yZW5kZXIuYmluZCh0aGlzKTtcclxuICAgICAgdGhpcy5oYW5kbGVLZXlEb3duID0gdGhpcy5oYW5kbGVLZXlEb3duLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcbiAgICBwdXNoQm9vbXMoeCwgeSkge1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbmZpZy5CT09NTlVNOyBpKyspIHtcclxuICAgICAgICB0aGlzLmJvb21zLnB1c2gobmV3IEJvb20oeCwgeSwgTWF0aC5yYW5kb20oKSAqIE1hdGguUEkgKiAyKSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGluaXQoKSB7XHJcbiAgICAgIHRoaXMubGlzdGVuSW5wdXQoKTtcclxuICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgIH1cclxuICAgIGxpc3RlbklucHV0KCkge1xyXG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93biwgZmFsc2UpO1xyXG4gICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNob290LCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBoYW5kbGVLZXlEb3duKCkge1xyXG4gICAgICBpZiAodGhpcy5zaWdsZUZpcmUpIHtcclxuICAgICAgICBjYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNob290LCBmYWxzZSk7XHJcbiAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuc2hvb3QsIGZhbHNlKTtcclxuICAgICAgICB0aGlzLnNpZ2xlRmlyZSA9IGZhbHNlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNhbnZhcy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLnNob290LCBmYWxzZSk7XHJcbiAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5zaG9vdCwgZmFsc2UpO1xyXG4gICAgICAgIHRoaXMuc2lnbGVGaXJlID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2hvb3QoZXZlbnQpIHtcclxuICAgICAgbGV0IHBvcyA9IGdldFBvc0luQ2FudmFzKGV2ZW50KTtcclxuICAgICAgLy8g5aaC5p6c5ZyoY2FudmFz6YeM6Z2iXHJcbiAgICAgIGlmIChpc0luQ2FudmFzKHBvcykpIHtcclxuICAgICAgICB0aGlzLmJpdS5wdXNoKG5ldyBCaXUoMCwgY2gsIHBvcy54LCBwb3MueSkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgIGN0eC5zYXZlKCk7XHJcbiAgICAgIGN0eC5maWxsU3R5bGUgPSAncmdiYSgwLDAsMCwwLjEpJztcclxuICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIGN3LCBjaCk7XHJcbiAgICAgIGN0eC5yZXN0b3JlKCk7XHJcbiAgICAgIHRoaXMuYml1LmZvckVhY2goKHYsIGkpID0+IHtcclxuICAgICAgICB2LmluaXQoKTtcclxuICAgICAgICBpZiAodi5vdmVyKSB7XHJcbiAgICAgICAgICB0aGlzLnB1c2hCb29tcyh2LnRhcmdldFgsIHYudGFyZ2V0WSk7XHJcbiAgICAgICAgICB0aGlzLmJpdS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5ib29tcy5mb3JFYWNoKCh2LCBpKSA9PiB7XHJcbiAgICAgICAgdi5pbml0KCk7XHJcbiAgICAgICAgaWYgKHYub3Zlcikge1xyXG4gICAgICAgICAgdGhpcy5ib29tcy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5yZW5kZXJJRCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlcik7XHJcbiAgICB9XHJcbiAgICBleGl0KCkge1xyXG4gICAgICBpZiAodGhpcy5yZW5kZXJJRCkge1xyXG4gICAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlcklEKTtcclxuICAgICAgfVxyXG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93biwgZmFsc2UpO1xyXG4gICAgICBjYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5zaG9vdCwgZmFsc2UpO1xyXG4gICAgICBjYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNob290LCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGxldCBnYW1lID0gbmV3IEdhbWUoKTtcclxuICBnYW1lLmluaXQoKTtcclxuICAvLyDov5Tlm57pgIDlh7rlh73mlbBcclxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgZ2FtZS5leGl0KCk7XHJcbiAgICBnYW1lID0gbnVsbDtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCBzZXRDYW52YXNTaXplKTtcclxuICAgIGNvbnNvbGUubG9nKCdvaycpO1xyXG4gIH07XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==