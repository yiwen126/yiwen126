(self.webpackChunkcanvas_blog=self.webpackChunkcanvas_blog||[]).push([[901,258],{258:()=>{window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.clearTimeout),window.utils={},utils.captureMouse=function(t){var e={x:0,y:0};return t.addEventListener("mousemove",(function(n){var i,o;n.pageX||n.pageY?(i=n.pageX,o=n.pageY):(i=n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=n.clientY+document.body.scrollTop+document.documentElement.scrollTop);var r=t.getBoundingClientRect();i=(i-r.left)*(t.width/r.width),o=(o-r.top)*(t.height/r.height),e.x=i,e.y=o}),!1),e}},901:(t,e,n)=>{"use strict";n.r(e),n.d(e,{init:()=>i});n(258);function i(){var t,e,n=document.getElementById("checkCollision"),i=n.getContext("2d");function o(){e=n.height=window.innerHeight;var i=n.closest("section");t=n.width=i.clientWidth}o(),window.addEventListener("resize",o);var r=function(){function t(t,e){this.vertexs=t,this.color=e,this.collide=!1}return t.prototype.draw=function(t){if(0!==this.vertexs.length){this.collide=!1;for(var e=0,n=this.vertexs.length;e<n;e++){if(0!==t.getImageData(this.vertexs[e].x,this.vertexs[e].y,1,1).data[3]){this.collide=!0;break}}t.save(),t.beginPath(),t.fillStyle=this.color,t.moveTo(this.vertexs[0].x,this.vertexs[0].y);for(e=1,n=this.vertexs.length;e<n;e++)t.lineTo(this.vertexs[e].x,this.vertexs[e].y);t.fill(),t.fillStyle="white",t.strokeStyle="black";for(e=0,n=this.vertexs.length;e<n;e++)t.beginPath(),t.arc(this.vertexs[e].x,this.vertexs[e].y,this.vertexs[e].r,0,2*Math.PI),t.fill(),t.stroke();t.restore()}},t}();function s(t){var e=n.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}var a=new(function(){function o(t){this.polygonList=t,this.drawID=void 0,this.draw=this.draw.bind(this),this.onmousedown=this.onmousedown.bind(this)}return o.prototype.init=function(){this.listenMouse(),this.draw()},o.prototype.listenMouse=function(){n.addEventListener("mousedown",this.onmousedown)},o.prototype.distance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},o.prototype.getVertex=function(t){for(var e=this,n=0,i=this.polygonList.length;n<i;n++){var o=this.polygonList[n].vertexs.find((function(n){return e.distance(t,n)<n.r}));if(o)return o}},o.prototype.getPolygon=function(t){var e=i.getImageData(t.x,t.y,1,1),n=new RegExp([e.data.slice(0,3),e.data[3]/255].join(","));return this.polygonList.find((function(t){return n.test(t.color.trim())}))},o.prototype.onmousedown=function(t){var e,i,o,r=s(t);if(i=(e=r).x,o=e.y,i>=0&&i<=n.width&&o>=0&&o<=n.height){var a=this.getVertex(r),x=this.getPolygon(r);if(a){var l=r.x-a.x,u=r.y-a.y,h=this.moveVertex.bind(this,l,u,a);n.addEventListener("mousemove",h),n.addEventListener("mouseup",(function t(){n.removeEventListener("mousemove",h),n.removeEventListener("mouseup",t)}))}else if(x){var d=this.movePolygon.bind(this,x);x.vertexs.forEach((function(t){t.dx=r.x-t.x,t.dy=r.y-t.y})),n.addEventListener("mousemove",d),n.addEventListener("mouseup",(function t(){n.removeEventListener("mousemove",d),n.removeEventListener("mouseup",t)}))}}},o.prototype.moveVertex=function(t,e,n,i){n.x=s(i).x-t,n.y=s(i).y-e},o.prototype.movePolygon=function(t,e){t.vertexs.forEach((function(t){t.x=s(e).x-t.dx,t.y=s(e).y-t.dy}))},o.prototype.getLineList=function(t){return t.map((function(t,e){for(var n=[],i=0,o=t.vertexs.length;i<o;i++){var r=(i+1)%o,s=t.vertexs[i],a=s.x,x=s.y,l=t.vertexs[r],u=l.x,h=l.y,d=(x-h)/(a-u),c=(h*a-x*u)/(a-u);n.push({k:d,b:c,point1:{x:a,y:x},point2:{x:u,y:h}})}return n}))},o.prototype.isLineCollision=function(t,e){return Math.abs(t.k)!==Math.abs(e.k)},o.prototype.getCollisionPos=function(t,e){var n=t.k,i=t.b,o=e.k,r=e.b;return Math.abs(n)===1/0?{x:t.point1.x,y:o*t.point1.x+r}:Math.abs(o)===1/0?{x:e.point1.x,y:n*e.point1.x+i}:{x:(r-i)/(n-o),y:(n*r-o*i)/(n-o)}},o.prototype.isContain=function(t,e){var n,i,o,r,s,a,x,l;return n=i=t.vertexs[0].x,o=r=t.vertexs[0].y,s=a=e.vertexs[0].x,x=l=e.vertexs[0].y,t.vertexs.forEach((function(t){t.x>n&&(n=t.x),t.x<i&&(i=t.x),t.y>o&&(o=t.y),t.y<r&&(r=t.y)})),e.vertexs.forEach((function(t){t.x>s&&(s=t.x),t.x<a&&(a=t.x),t.y>x&&(x=t.y),t.y<l&&(l=t.y)})),i<=a&&s<=n&&r<=l&&x<=o},o.prototype.isCollide=function(t){for(var e=0,n=t.length;e<n;e++){if(!0===t[e].collide)return!0;for(var o=0,r=t[e].vertexs.length;o<r;o++){var s=i.getImageData(t[e].vertexs[o].x,t[e].vertexs[o].y,1,1);if(255!==s.data[0]||255!==s.data[1]||255!==s.data[2]||255!==s.data[3])return t[e].collide=!0,!0}}for(var a=this.getLineList(t),x=0,l=a.length;x<l-1;x++){t[x];for(var u=0,h=a[x].length;u<h;u++)for(var d=a[x][u],c=x+1,y=a.length;c<y;c++){t[c];for(var m=0,v=a[c].length;m<v;m++){var w=a[c][m];if(this.isLineCollision(d,w)){var p=this.getCollisionPos(d,w);if(Math.min(d.point1.x,d.point2.x)<=p.x&&p.x<=Math.max(d.point1.x,d.point2.x)&&Math.min(w.point1.x,w.point2.x)<=p.x&&p.x<=Math.max(w.point1.x,w.point2.x)&&Math.min(d.point1.y,d.point2.y)<=p.y&&p.y<=Math.max(d.point1.y,d.point2.y)&&Math.min(w.point1.y,w.point2.y)<=p.y&&p.y<=Math.max(w.point1.y,w.point2.y))return!0}}}}return!1},o.prototype.draw=function(){i.clearRect(0,0,t,e),this.polygonList.forEach((function(t){t.draw(i)})),this.isCollide(this.polygonList)&&(i.fillStyle="red",i.textAlign="center",i.font="50px 楷体",i.fillText("碰撞",t/2,e/2)),this.drawID=window.requestAnimationFrame(this.draw)},o.prototype.exit=function(){this.drawID&&window.cancelAnimationFrame(this.drawID),n.removeEventListener("mousedown",this.onmousedown)},o}())([new r([{x:20,y:20,r:10},{x:100,y:20,r:10},{x:100,y:100,r:10},{x:20,y:100,r:10}],"rgba(255,0,0,1)"),new r([{x:180,y:120,r:10},{x:200,y:20,r:10},{x:220,y:120,r:10}],"rgba(0,255,0,1)"),new r([{x:20,y:180,r:10},{x:120,y:180,r:10},{x:140,y:220,r:10},{x:0,y:220,r:10}],"rgba(0,0,255,1)"),new r([{x:180,y:180,r:10},{x:200,y:160,r:10},{x:220,y:180,r:10},{x:240,y:160,r:10},{x:260,y:180,r:10},{x:260,y:220,r:10},{x:220,y:240,r:10},{x:180,y:220,r:10}],"rgba(100,100,100,1)")]);return a.init(),function(){a.exit(),a=null,window.removeEventListener("resize",o)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYW52YXMtYmxvZy8uL3NyYy9jbGllbnQvanMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vY2FudmFzLWJsb2cvLi9zcmMvY2xpZW50L2pzL2NoZWNrQ29sbGlzaW9uLnRzIl0sIm5hbWVzIjpbIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1velJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJtc1JlcXVlc3RBbmltYXRpb25GcmFtZSIsImNhbGxiYWNrIiwic2V0VGltZW91dCIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiY2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwid2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJ3ZWJraXRDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJtb3pDYW5jZWxBbmltYXRpb25GcmFtZSIsIm1vekNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1zQ2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJtc0NhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm9DYW5jZWxBbmltYXRpb25GcmFtZSIsIm9DYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjbGVhclRpbWVvdXQiLCJ1dGlscyIsImNhcHR1cmVNb3VzZSIsImVsZW1lbnQiLCJtb3VzZSIsIngiLCJ5IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicGFnZVgiLCJwYWdlWSIsImNsaWVudFgiLCJkb2N1bWVudCIsImJvZHkiLCJzY3JvbGxMZWZ0IiwiZG9jdW1lbnRFbGVtZW50IiwiY2xpZW50WSIsInNjcm9sbFRvcCIsIkJveCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImxlZnQiLCJ3aWR0aCIsInRvcCIsImhlaWdodCIsImluaXQiLCJjdyIsImNoIiwiY2FudmFzIiwiZ2V0RWxlbWVudEJ5SWQiLCJjdHgiLCJnZXRDb250ZXh0Iiwic2V0Q2FudmFzU2l6ZSIsImlubmVySGVpZ2h0Iiwic2VjdGlvbiIsImNsb3Nlc3QiLCJjbGllbnRXaWR0aCIsInZlcnRleHMiLCJjb2xvciIsInRoaXMiLCJjb2xsaWRlIiwiZHJhdyIsImxlbmd0aCIsImkiLCJsIiwiZ2V0SW1hZ2VEYXRhIiwiZGF0YSIsInNhdmUiLCJiZWdpblBhdGgiLCJmaWxsU3R5bGUiLCJtb3ZlVG8iLCJsaW5lVG8iLCJmaWxsIiwic3Ryb2tlU3R5bGUiLCJhcmMiLCJyIiwiTWF0aCIsIlBJIiwic3Ryb2tlIiwicmVzdG9yZSIsImdldFBvc0luQ2FudmFzIiwiZSIsInJlY3QiLCJteUNhbnZhcyIsInBvbHlnb25MaXN0IiwiZHJhd0lEIiwidW5kZWZpbmVkIiwiYmluZCIsIm9ubW91c2Vkb3duIiwibGlzdGVuTW91c2UiLCJkaXN0YW5jZSIsImEiLCJiIiwic3FydCIsInBvdyIsImdldFZlcnRleCIsInBvcyIsInZlcnRleCIsImZpbmQiLCJnZXRQb2x5Z29uIiwiaW1hZ2VEYXRhIiwicmVnIiwiUmVnRXhwIiwic2xpY2UiLCJqb2luIiwicG9seWdvbiIsInRlc3QiLCJ0cmltIiwiZHgiLCJkeSIsIm1vdmVWZXJ0ZXgiLCJfbW91c2V1cCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtb3ZlUG9seWdvbiIsImZvckVhY2giLCJnZXRMaW5lTGlzdCIsIm1hcCIsImxpbmUiLCJqIiwieDEiLCJ5MSIsIngyIiwieTIiLCJrIiwicHVzaCIsInBvaW50MSIsInBvaW50MiIsImlzTGluZUNvbGxpc2lvbiIsImxpbmUxIiwibGluZTIiLCJhYnMiLCJnZXRDb2xsaXNpb25Qb3MiLCJrMSIsImIxIiwiazIiLCJiMiIsIkluZmluaXR5IiwiaXNDb250YWluIiwicG9seWdvbjEiLCJwb2x5Z29uMiIsIngxbWF4IiwieDFtaW4iLCJ5MW1heCIsInkxbWluIiwieDJtYXgiLCJ4Mm1pbiIsInkybWF4IiwieTJtaW4iLCJ2IiwiaXNDb2xsaWRlIiwibGluZUxpc3QiLCJwMSIsImxwMSIsImwxIiwibGwxIiwicDIiLCJscDIiLCJsMiIsImxsMiIsIm1pbiIsIm1heCIsImNsZWFyUmVjdCIsInRleHRBbGlnbiIsImZvbnQiLCJmaWxsVGV4dCIsImV4aXQiLCJQb2x5Z29uIl0sIm1hcHBpbmdzIjoiMEZBQ0tBLE9BQU9DLHdCQUNWRCxPQUFPQyxzQkFDTEQsT0FBT0UsNkJBQ1BGLE9BQU9HLDBCQUNQSCxPQUFPSSx3QkFDUEosT0FBT0sseUJBQ1AsU0FBVUMsR0FDUixPQUFPTixPQUFPTyxXQUFXRCxFQUFVLElBQU8sTUFJM0NOLE9BQU9RLHVCQUNWUixPQUFPUSxxQkFDTFIsT0FBT1MsNkJBQ1BULE9BQU9VLDRCQUNQVixPQUFPVyxtQ0FDUFgsT0FBT1kseUJBQ1BaLE9BQU9hLGdDQUNQYixPQUFPYyx3QkFDUGQsT0FBT2UsK0JBQ1BmLE9BQU9nQix1QkFDUGhCLE9BQU9pQiw4QkFDUGpCLE9BQU9rQixjQUVYbEIsT0FBT21CLE1BQVEsR0FDZkEsTUFBTUMsYUFBZSxTQUFVQyxHQUM3QixJQUFJQyxFQUFRLENBQ1ZDLEVBQUcsRUFDSEMsRUFBRyxHQTJCTCxPQXhCQUgsRUFBUUksaUJBQ04sYUFDQSxTQUFVQyxHQUNSLElBQUlILEVBQUdDLEVBQ0hFLEVBQU1DLE9BQVNELEVBQU1FLE9BQ3ZCTCxFQUFJRyxFQUFNQyxNQUNWSCxFQUFJRSxFQUFNRSxRQUVWTCxFQUFJRyxFQUFNRyxRQUFVQyxTQUFTQyxLQUFLQyxXQUFhRixTQUFTRyxnQkFBZ0JELFdBQ3hFUixFQUFJRSxFQUFNUSxRQUFVSixTQUFTQyxLQUFLSSxVQUFZTCxTQUFTRyxnQkFBZ0JFLFdBR3pFLElBQUlDLEVBQU1mLEVBQVFnQix3QkFFbEJkLEdBQUtBLEVBQUlhLEVBQUlFLE9BQVNqQixFQUFRa0IsTUFBUUgsRUFBSUcsT0FDMUNmLEdBQUtBLEVBQUlZLEVBQUlJLE1BQVFuQixFQUFRb0IsT0FBU0wsRUFBSUssUUFFMUNuQixFQUFNQyxFQUFJQSxFQUNWRCxFQUFNRSxFQUFJQSxLQUdaLEdBR0tGLEksNkRDcENGLFNBQVNv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QUNyQixDQUFFakQsRUFBRyxFQUFHQyxFQUFHLElBQUtnRCxFQUFHLEtBRXJCLG1CQUVTLElBQUkyRixFQUNiLENBQ0UsQ0FBRTVJLEVBQUcsSUFBS0MsRUFBRyxJQUFLZ0QsRUFBRyxJQUNyQixDQUFFakQsRUFBRyxJQUFLQyxFQUFHLElBQUtnRCxFQUFHLElBQ3JCLENBQUVqRCxFQUFHLElBQUtDLEVBQUcsSUFBS2dELEVBQUcsSUFDckIsQ0FBRWpELEVBQUcsSUFBS0MsRUFBRyxJQUFLZ0QsRUFBRyxJQUNyQixDQUFFakQsRUFBRyxJQUFLQyxFQUFHLElBQUtnRCxFQUFHLElBQ3JCLENBQUVqRCxFQUFHLElBQUtDLEVBQUcsSUFBS2dELEVBQUcsSUFDckIsQ0FBRWpELEVBQUcsSUFBS0MsRUFBRyxJQUFLZ0QsRUFBRyxJQUNyQixDQUFFakQsRUFBRyxJQUFLQyxFQUFHLElBQUtnRCxFQUFHLEtBRXZCLHlCQUlKLE9BREFRLEVBQVN0QyxPQUNGLFdBQ0xzQyxFQUFTa0YsT0FDVGxGLEVBQVcsS0FDWGhGLE9BQU82RyxvQkFBb0IsU0FBVTVEIiwiZmlsZSI6IjkwMS5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL+WKqOeUu+WFvOWuuVxyXG5pZiAoIXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUpIHtcclxuICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID1cclxuICAgIHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgIHdpbmRvdy5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcbiAgICB3aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgIGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICByZXR1cm4gd2luZG93LnNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAgLyA2MCk7XHJcbiAgICB9O1xyXG59XHJcblxyXG5pZiAoIXdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSkge1xyXG4gIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSA9XHJcbiAgICB3aW5kb3cuY2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcbiAgICB3aW5kb3cud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcclxuICAgIHdpbmRvdy53ZWJraXRDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgIHdpbmRvdy5tb3pDYW5jZWxBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgd2luZG93Lm1vekNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgd2luZG93Lm1zQ2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcclxuICAgIHdpbmRvdy5tc0NhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgd2luZG93Lm9DYW5jZWxBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgd2luZG93Lm9DYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgIHdpbmRvdy5jbGVhclRpbWVvdXQ7XHJcbn1cclxud2luZG93LnV0aWxzID0ge307XHJcbnV0aWxzLmNhcHR1cmVNb3VzZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgdmFyIG1vdXNlID0ge1xyXG4gICAgeDogMCxcclxuICAgIHk6IDAsXHJcbiAgfTtcclxuXHJcbiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgJ21vdXNlbW92ZScsXHJcbiAgICBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgdmFyIHgsIHk7XHJcbiAgICAgIGlmIChldmVudC5wYWdlWCB8fCBldmVudC5wYWdlWSkge1xyXG4gICAgICAgIHggPSBldmVudC5wYWdlWDtcclxuICAgICAgICB5ID0gZXZlbnQucGFnZVk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgeCA9IGV2ZW50LmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdDtcclxuICAgICAgICB5ID0gZXZlbnQuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIEJveCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICB4ID0gKHggLSBCb3gubGVmdCkgKiAoZWxlbWVudC53aWR0aCAvIEJveC53aWR0aCk7XHJcbiAgICAgIHkgPSAoeSAtIEJveC50b3ApICogKGVsZW1lbnQuaGVpZ2h0IC8gQm94LmhlaWdodCk7XHJcblxyXG4gICAgICBtb3VzZS54ID0geDtcclxuICAgICAgbW91c2UueSA9IHk7XHJcbiAgICAgIGNvbnNvbGUubG9nKG1vdXNlKTtcclxuICAgIH0sXHJcbiAgICBmYWxzZSxcclxuICApO1xyXG5cclxuICByZXR1cm4gbW91c2U7XHJcbn07XHJcbiIsImltcG9ydCAnLi91dGlscyc7XHJcbmludGVyZmFjZSB2ZXJ0ZXgge1xyXG4gIHg6IG51bWJlcjtcclxuICB5OiBudW1iZXI7XHJcbiAgcjogbnVtYmVyO1xyXG4gIGR4PzogbnVtYmVyO1xyXG4gIGR5PzogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgcG9zIHtcclxuICB4OiBudW1iZXI7XHJcbiAgeTogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgbGluZSB7XHJcbiAgazogbnVtYmVyO1xyXG4gIGI6IG51bWJlcjtcclxuICBwb2ludDE6IHBvcztcclxuICBwb2ludDI6IHBvcztcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gaW5pdCgpIHtcclxuICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hlY2tDb2xsaXNpb24nKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuICBsZXQgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJykgYXMgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG4gIGxldCBjdzogbnVtYmVyLCBjaDogbnVtYmVyO1xyXG4gIGZ1bmN0aW9uIHNldENhbnZhc1NpemUoKSB7XHJcbiAgICAvLyDms6jmhI/ov5nph4znmoTpobrluo/opoHlhYjpq5jluqbvvIjlh7rmu5rliqjmnaHvvInlkI7lrr3luqZcclxuICAgIGNoID0gY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxuICAgIGxldCBzZWN0aW9uID0gY2FudmFzLmNsb3Nlc3QoJ3NlY3Rpb24nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgIGN3ID0gY2FudmFzLndpZHRoID0gc2VjdGlvbi5jbGllbnRXaWR0aDtcclxuICB9XHJcbiAgc2V0Q2FudmFzU2l6ZSgpO1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBzZXRDYW52YXNTaXplKTtcclxuICAvLyDlpJrovrnlvaJcclxuICBjbGFzcyBQb2x5Z29uIHtcclxuICAgIHZlcnRleHM7XHJcbiAgICBjb2xvcjtcclxuICAgIGNvbGxpZGU6IGJvb2xlYW47XHJcbiAgICBjb25zdHJ1Y3Rvcih2ZXJ0ZXhzOiB2ZXJ0ZXhbXSwgY29sb3I6IHN0cmluZykge1xyXG4gICAgICB0aGlzLnZlcnRleHMgPSB2ZXJ0ZXhzO1xyXG4gICAgICB0aGlzLmNvbG9yID0gY29sb3I7XHJcbiAgICAgIHRoaXMuY29sbGlkZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZHJhdyhjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCkge1xyXG4gICAgICBpZiAodGhpcy52ZXJ0ZXhzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICAvLyDmr4/mrKHnu5jliLbliY3liKTmlq3pobbngrnmmK/lkKbljIXlkKvlnKjlhbbku5blpJrovrnlvaLlhoXvvIjpgJrov4fpopzoibLliKTmlq3vvInvvIznu5PlkIjkuqTngrnms5Xlj6/ku6Xlroznvo7lrp7njrDnorDmkp7mo4DmtYtcclxuICAgICAgdGhpcy5jb2xsaWRlID0gZmFsc2U7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy52ZXJ0ZXhzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGxldCBpbWFnZURhdGEgPSBjdHguZ2V0SW1hZ2VEYXRhKHRoaXMudmVydGV4c1tpXS54LCB0aGlzLnZlcnRleHNbaV0ueSwgMSwgMSk7XHJcbiAgICAgICAgaWYgKGltYWdlRGF0YS5kYXRhWzNdICE9PSAwKSB7XHJcbiAgICAgICAgICAvLyDlpoLmnpzlnKjlhbbku5blpJrovrnlvaLlhoVcclxuICAgICAgICAgIHRoaXMuY29sbGlkZSA9IHRydWU7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy8g57uY5Yi25aSa6L655b2iXHJcbiAgICAgIGN0eC5zYXZlKCk7XHJcbiAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgLy8gY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICd4b3InO1xyXG5cclxuICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuY29sb3I7XHJcblxyXG4gICAgICBjdHgubW92ZVRvKHRoaXMudmVydGV4c1swXS54LCB0aGlzLnZlcnRleHNbMF0ueSk7XHJcbiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gdGhpcy52ZXJ0ZXhzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGN0eC5saW5lVG8odGhpcy52ZXJ0ZXhzW2ldLngsIHRoaXMudmVydGV4c1tpXS55KTtcclxuICAgICAgfVxyXG4gICAgICBjdHguZmlsbCgpO1xyXG4gICAgICAvLyDnu5jliLblpJrovrnlvaLpobbngrlcclxuICAgICAgY3R4LmZpbGxTdHlsZSA9ICd3aGl0ZSc7XHJcbiAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICdibGFjayc7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy52ZXJ0ZXhzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICBjdHguYXJjKHRoaXMudmVydGV4c1tpXS54LCB0aGlzLnZlcnRleHNbaV0ueSwgdGhpcy52ZXJ0ZXhzW2ldLnIsIDAsIDIgKiBNYXRoLlBJKTtcclxuICAgICAgICBjdHguZmlsbCgpO1xyXG4gICAgICAgIGN0eC5zdHJva2UoKTtcclxuICAgICAgfVxyXG4gICAgICBjdHgucmVzdG9yZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0UG9zSW5DYW52YXMoZTogTW91c2VFdmVudCkge1xyXG4gICAgbGV0IHJlY3QgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiBlLmNsaWVudFggLSByZWN0LmxlZnQsXHJcbiAgICAgIHk6IGUuY2xpZW50WSAtIHJlY3QudG9wLFxyXG4gICAgfTtcclxuICB9XHJcbiAgZnVuY3Rpb24gaXNJbkNhbnZhcyh7IHgsIHkgfTogcG9zKSB7XHJcbiAgICByZXR1cm4geCA+PSAwICYmIHggPD0gY2FudmFzLndpZHRoICYmIHkgPj0gMCAmJiB5IDw9IGNhbnZhcy5oZWlnaHQ7XHJcbiAgfVxyXG4gIGNsYXNzIENhbnZhcyB7XHJcbiAgICBkcmF3SUQ6IG51bWJlciB8IHVuZGVmaW5lZDtcclxuICAgIHBvbHlnb25MaXN0O1xyXG4gICAgY29uc3RydWN0b3IocG9seWdvbkxpc3Q6IFBvbHlnb25bXSkge1xyXG4gICAgICB0aGlzLnBvbHlnb25MaXN0ID0gcG9seWdvbkxpc3Q7XHJcbiAgICAgIHRoaXMuZHJhd0lEID0gdW5kZWZpbmVkO1xyXG4gICAgICB0aGlzLmRyYXcgPSB0aGlzLmRyYXcuYmluZCh0aGlzKTtcclxuICAgICAgdGhpcy5vbm1vdXNlZG93biA9IHRoaXMub25tb3VzZWRvd24uYmluZCh0aGlzKTtcclxuICAgIH1cclxuICAgIGluaXQoKSB7XHJcbiAgICAgIHRoaXMubGlzdGVuTW91c2UoKTtcclxuICAgICAgdGhpcy5kcmF3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgbGlzdGVuTW91c2UoKSB7XHJcbiAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9ubW91c2Vkb3duKTtcclxuICAgIH1cclxuICAgIGRpc3RhbmNlKGE6IHBvcywgYjogcG9zKSB7XHJcbiAgICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3coYS54IC0gYi54LCAyKSArIE1hdGgucG93KGEueSAtIGIueSwgMikpO1xyXG4gICAgfVxyXG4gICAgZ2V0VmVydGV4KHBvczogcG9zKSB7XHJcbiAgICAgIC8vIGRlYnVnZ2VyO1xyXG4gICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMucG9seWdvbkxpc3QubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IHZlcnRleCA9IHRoaXMucG9seWdvbkxpc3RbaV0udmVydGV4cy5maW5kKCh2ZXJ0ZXgpID0+IHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmRpc3RhbmNlKHBvcywgdmVydGV4KSA8IHZlcnRleC5yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh2ZXJ0ZXgpIHtcclxuICAgICAgICAgIHJldHVybiB2ZXJ0ZXg7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXRQb2x5Z29uKHBvczogcG9zKSB7XHJcbiAgICAgIGxldCBpbWFnZURhdGEgPSBjdHguZ2V0SW1hZ2VEYXRhKHBvcy54LCBwb3MueSwgMSwgMSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGltYWdlRGF0YSk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhbaW1hZ2VEYXRhLmRhdGEuc2xpY2UoMCwgMyksIGltYWdlRGF0YS5kYXRhWzNdIC8gMjU1XS5qb2luKCcsJykpO1xyXG4gICAgICBsZXQgcmVnID0gbmV3IFJlZ0V4cChbaW1hZ2VEYXRhLmRhdGEuc2xpY2UoMCwgMyksIGltYWdlRGF0YS5kYXRhWzNdIC8gMjU1XS5qb2luKCcsJykpO1xyXG4gICAgICByZXR1cm4gdGhpcy5wb2x5Z29uTGlzdC5maW5kKChwb2x5Z29uKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHJlZy50ZXN0KHBvbHlnb24uY29sb3IudHJpbSgpKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBvbm1vdXNlZG93bihlOiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgIGxldCBfdGhpcyA9IHRoaXM7XHJcbiAgICAgIGxldCBwb3MgPSBnZXRQb3NJbkNhbnZhcyhlKTtcclxuICAgICAgLy8g5aaC5p6c5ZyoY2FudmFz6YeM6Z2iXHJcbiAgICAgIGlmIChpc0luQ2FudmFzKHBvcykpIHtcclxuICAgICAgICAvLyDpobbngrlcclxuICAgICAgICBsZXQgdmVydGV4ID0gdGhpcy5nZXRWZXJ0ZXgocG9zKTtcclxuXHJcbiAgICAgICAgLy8g5aSa6L655b2iXHJcbiAgICAgICAgbGV0IHBvbHlnb24gPSB0aGlzLmdldFBvbHlnb24ocG9zKTtcclxuICAgICAgICBpZiAodmVydGV4KSB7XHJcbiAgICAgICAgICAvLyDlpoLmnpzpgInkuK3kuobpobbngrnvvIzlsLHlj6/ku6XmlLnlj5jlroNcclxuICAgICAgICAgIGxldCBkeCA9IHBvcy54IC0gdmVydGV4LngsXHJcbiAgICAgICAgICAgIGR5ID0gcG9zLnkgLSB2ZXJ0ZXgueTtcclxuICAgICAgICAgIGxldCBtb3ZlVmVydGV4ID0gdGhpcy5tb3ZlVmVydGV4LmJpbmQodGhpcywgZHgsIGR5LCB2ZXJ0ZXgpO1xyXG4gICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG1vdmVWZXJ0ZXgpO1xyXG4gICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBmdW5jdGlvbiBfbW91c2V1cCgpIHtcclxuICAgICAgICAgICAgY2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG1vdmVWZXJ0ZXgpO1xyXG4gICAgICAgICAgICBjYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIF9tb3VzZXVwKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocG9seWdvbikge1xyXG4gICAgICAgICAgLy8g5aaC5p6c6YCJ5Lit5LqG5aSa6L655b2i77yM5bCx5Y+v5Lul56e75Yqo5a6DXHJcbiAgICAgICAgICBsZXQgbW92ZVBvbHlnb24gPSB0aGlzLm1vdmVQb2x5Z29uLmJpbmQodGhpcywgcG9seWdvbik7XHJcbiAgICAgICAgICBwb2x5Z29uLnZlcnRleHMuZm9yRWFjaCgodmVydGV4KSA9PiB7XHJcbiAgICAgICAgICAgIHZlcnRleC5keCA9IHBvcy54IC0gdmVydGV4Lng7XHJcbiAgICAgICAgICAgIHZlcnRleC5keSA9IHBvcy55IC0gdmVydGV4Lnk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBtb3ZlUG9seWdvbik7XHJcbiAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIGZ1bmN0aW9uIF9tb3VzZXVwKCkge1xyXG4gICAgICAgICAgICBjYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgbW92ZVBvbHlnb24pO1xyXG4gICAgICAgICAgICBjYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIF9tb3VzZXVwKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbW92ZVZlcnRleChkeDogbnVtYmVyLCBkeTogbnVtYmVyLCB2ZXJ0ZXg6IHZlcnRleCwgZTogTW91c2VFdmVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnbW92ZVZlcnRleC0tLS0tLS0tJyk7XHJcbiAgICAgIHZlcnRleC54ID0gZ2V0UG9zSW5DYW52YXMoZSkueCAtIGR4O1xyXG4gICAgICB2ZXJ0ZXgueSA9IGdldFBvc0luQ2FudmFzKGUpLnkgLSBkeTtcclxuICAgIH1cclxuICAgIG1vdmVQb2x5Z29uKHBvbHlnb246IHsgdmVydGV4czogYW55W10gfSwgZTogTW91c2VFdmVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnbW92ZVBvbHlnb24tLS0tLS0tLS0nKTtcclxuICAgICAgcG9seWdvbi52ZXJ0ZXhzLmZvckVhY2goKHZlcnRleDogeyB4OiBudW1iZXI7IGR4OiBudW1iZXI7IHk6IG51bWJlcjsgZHk6IG51bWJlciB9KSA9PiB7XHJcbiAgICAgICAgdmVydGV4LnggPSBnZXRQb3NJbkNhbnZhcyhlKS54IC0gdmVydGV4LmR4O1xyXG4gICAgICAgIHZlcnRleC55ID0gZ2V0UG9zSW5DYW52YXMoZSkueSAtIHZlcnRleC5keTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBnZXRMaW5lTGlzdChwb2x5Z29uTGlzdDogUG9seWdvbltdKTogbGluZVtdW10ge1xyXG4gICAgICByZXR1cm4gcG9seWdvbkxpc3QubWFwKChwb2x5Z29uLCBpKSA9PiB7XHJcbiAgICAgICAgbGV0IGxpbmU6IEFycmF5PHsgazogbnVtYmVyOyBiOiBudW1iZXI7IHBvaW50MTogcG9zOyBwb2ludDI6IHBvcyB9PiA9IFtdOyAvLyDlrZjmlL7nm7Tnur/mlrnnqItcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHBvbHlnb24udmVydGV4cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgIGxldCBqID0gKGkgKyAxKSAlIGw7XHJcbiAgICAgICAgICBsZXQgeyB4OiB4MSwgeTogeTEgfSA9IHBvbHlnb24udmVydGV4c1tpXSxcclxuICAgICAgICAgICAgeyB4OiB4MiwgeTogeTIgfSA9IHBvbHlnb24udmVydGV4c1tqXTtcclxuICAgICAgICAgIGxldCBrID0gKHkxIC0geTIpIC8gKHgxIC0geDIpLFxyXG4gICAgICAgICAgICBiID0gKHkyICogeDEgLSB5MSAqIHgyKSAvICh4MSAtIHgyKTtcclxuICAgICAgICAgIGxpbmUucHVzaCh7IGssIGIsIHBvaW50MTogeyB4OiB4MSwgeTogeTEgfSwgcG9pbnQyOiB7IHg6IHgyLCB5OiB5MiB9IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGluZTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpc0xpbmVDb2xsaXNpb24obGluZTE6IGxpbmUsIGxpbmUyOiBsaW5lKTogYm9vbGVhbiB7XHJcbiAgICAgIGlmIChNYXRoLmFicyhsaW5lMS5rKSA9PT0gTWF0aC5hYnMobGluZTIuaykpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGdldENvbGxpc2lvblBvcyhsaW5lMTogbGluZSwgbGluZTI6IGxpbmUpOiBwb3Mge1xyXG4gICAgICBsZXQgeyBrOiBrMSwgYjogYjEgfSA9IGxpbmUxLFxyXG4gICAgICAgIHsgazogazIsIGI6IGIyIH0gPSBsaW5lMjtcclxuICAgICAgaWYgKE1hdGguYWJzKGsxKSA9PT0gSW5maW5pdHkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgeDogbGluZTEucG9pbnQxLngsXHJcbiAgICAgICAgICB5OiBrMiAqIGxpbmUxLnBvaW50MS54ICsgYjIsXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoTWF0aC5hYnMoazIpID09PSBJbmZpbml0eSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB4OiBsaW5lMi5wb2ludDEueCxcclxuICAgICAgICAgIHk6IGsxICogbGluZTIucG9pbnQxLnggKyBiMSxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgeDogKGIyIC0gYjEpIC8gKGsxIC0gazIpLFxyXG4gICAgICAgIHk6IChrMSAqIGIyIC0gazIgKiBiMSkgLyAoazEgLSBrMiksXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICAvLyDmo4Dmn6Vwb2x5Z29uMeaYr+WQpuWMheWQq3BvbHlnb24yXHJcbiAgICBpc0NvbnRhaW4ocG9seWdvbjE6IFBvbHlnb24sIHBvbHlnb24yOiBQb2x5Z29uKTogYm9vbGVhbiB7XHJcbiAgICAgIGxldCB4MW1heDogbnVtYmVyLCB4MW1pbjogbnVtYmVyLCB5MW1heDogbnVtYmVyLCB5MW1pbjogbnVtYmVyLCB4Mm1heDogbnVtYmVyLCB4Mm1pbjogbnVtYmVyLCB5Mm1heDogbnVtYmVyLCB5Mm1pbjogbnVtYmVyO1xyXG4gICAgICAoeDFtYXggPSB4MW1pbiA9IHBvbHlnb24xLnZlcnRleHNbMF0ueCksXHJcbiAgICAgICAgKHkxbWF4ID0geTFtaW4gPSBwb2x5Z29uMS52ZXJ0ZXhzWzBdLnkpLFxyXG4gICAgICAgICh4Mm1heCA9IHgybWluID0gcG9seWdvbjIudmVydGV4c1swXS54KSxcclxuICAgICAgICAoeTJtYXggPSB5Mm1pbiA9IHBvbHlnb24yLnZlcnRleHNbMF0ueSk7XHJcblxyXG4gICAgICBwb2x5Z29uMS52ZXJ0ZXhzLmZvckVhY2goKHYpID0+IHtcclxuICAgICAgICBpZiAodi54ID4geDFtYXgpIHtcclxuICAgICAgICAgIHgxbWF4ID0gdi54O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodi54IDwgeDFtaW4pIHtcclxuICAgICAgICAgIHgxbWluID0gdi54O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodi55ID4geTFtYXgpIHtcclxuICAgICAgICAgIHkxbWF4ID0gdi55O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodi55IDwgeTFtaW4pIHtcclxuICAgICAgICAgIHkxbWluID0gdi55O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIHBvbHlnb24yLnZlcnRleHMuZm9yRWFjaCgodikgPT4ge1xyXG4gICAgICAgIGlmICh2LnggPiB4Mm1heCkge1xyXG4gICAgICAgICAgeDJtYXggPSB2Lng7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2LnggPCB4Mm1pbikge1xyXG4gICAgICAgICAgeDJtaW4gPSB2Lng7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2LnkgPiB5Mm1heCkge1xyXG4gICAgICAgICAgeTJtYXggPSB2Lnk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2LnkgPCB5Mm1pbikge1xyXG4gICAgICAgICAgeTJtaW4gPSB2Lnk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgLy8gaWYoKVxyXG4gICAgICByZXR1cm4geDFtaW4gPD0geDJtaW4gJiYgeDJtYXggPD0geDFtYXggJiYgeTFtaW4gPD0geTJtaW4gJiYgeTJtYXggPD0geTFtYXg7XHJcbiAgICB9XHJcbiAgICBpc0NvbGxpZGUocG9seWdvbkxpc3Q6IFBvbHlnb25bXSkge1xyXG4gICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHBvbHlnb25MaXN0Lmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGlmIChwb2x5Z29uTGlzdFtpXS5jb2xsaWRlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAvLyDlpoLmnpzpobbngrnlnKjnu5jliLbliY3lsLHnoa7lrprlnKjlhbbku5blpJrovrnlvaLkuK1cclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBqID0gMCwgbCA9IHBvbHlnb25MaXN0W2ldLnZlcnRleHMubGVuZ3RoOyBqIDwgbDsgaisrKSB7XHJcbiAgICAgICAgICBsZXQgaW1hZ2VEYXRhID0gY3R4LmdldEltYWdlRGF0YShwb2x5Z29uTGlzdFtpXS52ZXJ0ZXhzW2pdLngsIHBvbHlnb25MaXN0W2ldLnZlcnRleHNbal0ueSwgMSwgMSk7XHJcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpbWFnZURhdGEuZGF0YSk7XHJcbiAgICAgICAgICBpZiAoaW1hZ2VEYXRhLmRhdGFbMF0gIT09IDI1NSB8fCBpbWFnZURhdGEuZGF0YVsxXSAhPT0gMjU1IHx8IGltYWdlRGF0YS5kYXRhWzJdICE9PSAyNTUgfHwgaW1hZ2VEYXRhLmRhdGFbM10gIT09IDI1NSkge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzpobbngrnlnKjnu5jliLbkuYvlkI7lj5HnjrDlnKjlhbbku5blpJrovrnlvaLkuK1cclxuICAgICAgICAgICAgcG9seWdvbkxpc3RbaV0uY29sbGlkZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGxpbmVMaXN0ID0gdGhpcy5nZXRMaW5lTGlzdChwb2x5Z29uTGlzdCk7XHJcbiAgICAgIGZvciAobGV0IHAxID0gMCwgbHAxID0gbGluZUxpc3QubGVuZ3RoOyBwMSA8IGxwMSAtIDE7IHAxKyspIHtcclxuICAgICAgICBsZXQgcG9seWdvbjEgPSBwb2x5Z29uTGlzdFtwMV07XHJcbiAgICAgICAgZm9yIChsZXQgbDEgPSAwLCBsbDEgPSBsaW5lTGlzdFtwMV0ubGVuZ3RoOyBsMSA8IGxsMTsgbDErKykge1xyXG4gICAgICAgICAgbGV0IGxpbmUxID0gbGluZUxpc3RbcDFdW2wxXTtcclxuICAgICAgICAgIGZvciAobGV0IHAyID0gcDEgKyAxLCBscDIgPSBsaW5lTGlzdC5sZW5ndGg7IHAyIDwgbHAyOyBwMisrKSB7XHJcbiAgICAgICAgICAgIGxldCBwb2x5Z29uMiA9IHBvbHlnb25MaXN0W3AyXTtcclxuICAgICAgICAgICAgLy8gaWYgKHRoaXMuaXNDb250YWluKHBvbHlnb24xLCBwb2x5Z29uMikgfHwgdGhpcy5pc0NvbnRhaW4ocG9seWdvbjIsIHBvbHlnb24xKSkge1xyXG4gICAgICAgICAgICAvLyAgIC8vIOWmguaenOS4gOS4quWkmui+ueW9ouWujOWFqOWMheWQq+WPpuS4gOS4quWkmui+ueW9olxyXG4gICAgICAgICAgICAvLyAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIGZvciAobGV0IGwyID0gMCwgbGwyID0gbGluZUxpc3RbcDJdLmxlbmd0aDsgbDIgPCBsbDI7IGwyKyspIHtcclxuICAgICAgICAgICAgICBsZXQgbGluZTIgPSBsaW5lTGlzdFtwMl1bbDJdO1xyXG5cclxuICAgICAgICAgICAgICBpZiAodGhpcy5pc0xpbmVDb2xsaXNpb24obGluZTEsIGxpbmUyKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHBvcyA9IHRoaXMuZ2V0Q29sbGlzaW9uUG9zKGxpbmUxLCBsaW5lMik7XHJcbiAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgIE1hdGgubWluKGxpbmUxLnBvaW50MS54LCBsaW5lMS5wb2ludDIueCkgPD0gcG9zLnggJiZcclxuICAgICAgICAgICAgICAgICAgcG9zLnggPD0gTWF0aC5tYXgobGluZTEucG9pbnQxLngsIGxpbmUxLnBvaW50Mi54KSAmJlxyXG4gICAgICAgICAgICAgICAgICBNYXRoLm1pbihsaW5lMi5wb2ludDEueCwgbGluZTIucG9pbnQyLngpIDw9IHBvcy54ICYmXHJcbiAgICAgICAgICAgICAgICAgIHBvcy54IDw9IE1hdGgubWF4KGxpbmUyLnBvaW50MS54LCBsaW5lMi5wb2ludDIueCkgJiZcclxuICAgICAgICAgICAgICAgICAgTWF0aC5taW4obGluZTEucG9pbnQxLnksIGxpbmUxLnBvaW50Mi55KSA8PSBwb3MueSAmJlxyXG4gICAgICAgICAgICAgICAgICBwb3MueSA8PSBNYXRoLm1heChsaW5lMS5wb2ludDEueSwgbGluZTEucG9pbnQyLnkpICYmXHJcbiAgICAgICAgICAgICAgICAgIE1hdGgubWluKGxpbmUyLnBvaW50MS55LCBsaW5lMi5wb2ludDIueSkgPD0gcG9zLnkgJiZcclxuICAgICAgICAgICAgICAgICAgcG9zLnkgPD0gTWF0aC5tYXgobGluZTIucG9pbnQxLnksIGxpbmUyLnBvaW50Mi55KVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vIOWmguaenOS6pOeCueWcqOS4pOadoee6v+auteS4ilxyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZHJhdygpIHtcclxuICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjdywgY2gpO1xyXG4gICAgICB0aGlzLnBvbHlnb25MaXN0LmZvckVhY2goKHYpID0+IHtcclxuICAgICAgICB2LmRyYXcoY3R4KTtcclxuICAgICAgfSk7XHJcbiAgICAgIGlmICh0aGlzLmlzQ29sbGlkZSh0aGlzLnBvbHlnb25MaXN0KSkge1xyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSAncmVkJztcclxuICAgICAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcic7XHJcbiAgICAgICAgY3R4LmZvbnQgPSAnNTBweCDmpbfkvZMnO1xyXG4gICAgICAgIGN0eC5maWxsVGV4dCgn56Kw5pKeJywgY3cgLyAyLCBjaCAvIDIpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZHJhd0lEID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmRyYXcpO1xyXG4gICAgfVxyXG4gICAgZXhpdCgpIHtcclxuICAgICAgaWYgKHRoaXMuZHJhd0lEKSB7XHJcbiAgICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuZHJhd0lEKTtcclxuICAgICAgfVxyXG4gICAgICBjYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5vbm1vdXNlZG93bik7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGxldCBwb2x5Z29uMSA9IG5ldyBQb2x5Z29uKFxyXG4gICAgICBbXHJcbiAgICAgICAgeyB4OiAyMCwgeTogMjAsIHI6IDEwIH0sXHJcbiAgICAgICAgeyB4OiAxMDAsIHk6IDIwLCByOiAxMCB9LFxyXG4gICAgICAgIHsgeDogMTAwLCB5OiAxMDAsIHI6IDEwIH0sXHJcbiAgICAgICAgeyB4OiAyMCwgeTogMTAwLCByOiAxMCB9LFxyXG4gICAgICBdLFxyXG4gICAgICAncmdiYSgyNTUsMCwwLDEpJyxcclxuICAgICksXHJcbiAgICBwb2x5Z29uMiA9IG5ldyBQb2x5Z29uKFxyXG4gICAgICBbXHJcbiAgICAgICAgeyB4OiAxODAsIHk6IDEyMCwgcjogMTAgfSxcclxuICAgICAgICB7IHg6IDIwMCwgeTogMjAsIHI6IDEwIH0sXHJcbiAgICAgICAgeyB4OiAyMjAsIHk6IDEyMCwgcjogMTAgfSxcclxuICAgICAgXSxcclxuICAgICAgJ3JnYmEoMCwyNTUsMCwxKScsXHJcbiAgICApLFxyXG4gICAgcG9seWdvbjMgPSBuZXcgUG9seWdvbihcclxuICAgICAgW1xyXG4gICAgICAgIHsgeDogMjAsIHk6IDE4MCwgcjogMTAgfSxcclxuICAgICAgICB7IHg6IDEyMCwgeTogMTgwLCByOiAxMCB9LFxyXG4gICAgICAgIHsgeDogMTQwLCB5OiAyMjAsIHI6IDEwIH0sXHJcbiAgICAgICAgeyB4OiAwLCB5OiAyMjAsIHI6IDEwIH0sXHJcbiAgICAgIF0sXHJcbiAgICAgICdyZ2JhKDAsMCwyNTUsMSknLFxyXG4gICAgKSxcclxuICAgIHBvbHlnb240ID0gbmV3IFBvbHlnb24oXHJcbiAgICAgIFtcclxuICAgICAgICB7IHg6IDE4MCwgeTogMTgwLCByOiAxMCB9LFxyXG4gICAgICAgIHsgeDogMjAwLCB5OiAxNjAsIHI6IDEwIH0sXHJcbiAgICAgICAgeyB4OiAyMjAsIHk6IDE4MCwgcjogMTAgfSxcclxuICAgICAgICB7IHg6IDI0MCwgeTogMTYwLCByOiAxMCB9LFxyXG4gICAgICAgIHsgeDogMjYwLCB5OiAxODAsIHI6IDEwIH0sXHJcbiAgICAgICAgeyB4OiAyNjAsIHk6IDIyMCwgcjogMTAgfSxcclxuICAgICAgICB7IHg6IDIyMCwgeTogMjQwLCByOiAxMCB9LFxyXG4gICAgICAgIHsgeDogMTgwLCB5OiAyMjAsIHI6IDEwIH0sXHJcbiAgICAgIF0sXHJcbiAgICAgICdyZ2JhKDEwMCwxMDAsMTAwLDEpJyxcclxuICAgICk7XHJcbiAgbGV0IG15Q2FudmFzOiBhbnkgPSBuZXcgQ2FudmFzKFtwb2x5Z29uMSwgcG9seWdvbjIsIHBvbHlnb24zLCBwb2x5Z29uNF0pO1xyXG4gIG15Q2FudmFzLmluaXQoKTtcclxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgbXlDYW52YXMuZXhpdCgpO1xyXG4gICAgbXlDYW52YXMgPSBudWxsO1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHNldENhbnZhc1NpemUpO1xyXG4gIH07XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==